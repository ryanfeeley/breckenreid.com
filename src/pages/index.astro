---
import Layout from '../layouts/Layout.astro';
import PostCard from '../components/PostCard.astro';
import { getCollection } from 'astro:content';

const allPages = await getCollection('pages');

const posts = allPages
  .filter((item) => item.data.pagetype?.includes('main'))
  .sort((a, b) => {
    const numA = a.data.number || 9999;
    const numB = b.data.number || 9999;
    return numA - numB;
  });

const indexPage = allPages.find((p) => p.slug === 'index');
const title = indexPage?.data.title || 'Julia Breckenreid';
const description = indexPage?.data.description;

let postCounter = 0;
---

<Layout title={title} description={description}>
  <div class="post-feed">
    {posts.map((post) => {
      postCounter++;

      return <PostCard count={postCounter} post={post} slug={post.slug} />;
    })}
  </div>
</Layout>
